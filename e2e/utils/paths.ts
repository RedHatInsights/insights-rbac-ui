/**
 * Path utilities for E2E tests
 *
 * Centralizes path resolution to avoid ambiguity between relative paths
 * that behave differently depending on where Playwright is invoked from.
 */
import * as path from 'path';
import { fileURLToPath } from 'url';

// Get the directory of this file (e2e/utils/)
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// E2E root directory
export const E2E_ROOT = path.resolve(__dirname, '..');

/**
 * Auth directory
 */
export const AUTH_DIR = path.join(E2E_ROOT, 'auth');

/**
 * Storage state file paths
 *
 * These are generated by the CLI login command:
 *   npm run cli -- login --headless --save-state e2e/auth/v1-admin.json
 *
 * V1 = Legacy User Access experience (/iam/user-access/*)
 * V2 = Access Management experience (/iam/access-management/*)
 */
export const AUTH_V1_ADMIN = path.join(AUTH_DIR, 'v1-admin.json');
export const AUTH_V1_USER = path.join(AUTH_DIR, 'v1-user.json');
export const AUTH_V2_ADMIN = path.join(AUTH_DIR, 'v2-admin.json');
export const AUTH_V2_USER = path.join(AUTH_DIR, 'v2-user.json');

// Legacy exports for backward compatibility during migration
export const AUTH_ADMIN = AUTH_V1_ADMIN;
export const AUTH_USER = AUTH_V1_USER;

/**
 * Seed map file path
 *
 * Generated by the CLI seed command:
 *   npm run cli -- seed --file e2e/fixtures/seed.json --prefix "ci-" --json > e2e/seed-map.json
 */
export const SEED_MAP_PATH = path.join(E2E_ROOT, 'seed-map.json');

/**
 * Fixture files
 */
export const FIXTURES_DIR = path.join(E2E_ROOT, 'fixtures');
export const SEED_FILE = path.join(FIXTURES_DIR, 'seed.json');

/**
 * Seeded resource names (before prefix is applied)
 * Use these constants when searching for seeded data in tests.
 */
export const SEEDED_ROLE_NAME = 'Seeded_Role';
export const SEEDED_GROUP_NAME = 'Seeded_Group';
export const SEEDED_WORKSPACE_NAME = 'Seeded_Workspace';
